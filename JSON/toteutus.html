<!DOCTYPE html>
<html lang="fi">

<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="UTF-8">
    <title>JSON-harjoitussivusto</title>

    <!--  Bootstrap CSS ja JS linkitys -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Lomakekenttien laitto vasemmalta tasan -->
    <style>
        label {
            display: block;
            width: 6em;
            float: left;
        }
    </style>
</head>


<body>
    <!-- Navikointipalkki -->
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
        <div class="container-fluid">
            <a class="navbar-brand" href="index.html">Navikointipalkki</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="index.html">Ensimmäinen tietue</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="toteutus.html">Toinen tietue</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="taulukko.html">Taulukko</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <div id="vastaus"></div>

    <script>
        "use strict"
        fetch('tietue2.JSON')
            .then(function (vastaus) {
                console.log(vastaus);
                return vastaus.json();
            })
            .then(function (vastausJSON) {
                kerro(vastausJSON);
            })
            .catch(function (virhe) {
                document.getElementById("vastaus").innerHTML = "<p>Tietojen hakeminen epäonnistui</p>";
            });
        function kerro(vastausJSON) {
            let vastaus = "<h1>" + vastausJSON.toteutuksen_nimi + "</h1><br> " +
                vastausJSON.osallistujat.length + " kpl <br><hr>";
            for (var i = 0; i < vastausJSON.osallistujat.length; i++) {
                vastaus += "<b>" + vastausJSON.osallistujat[i].e_nimi + "</b> ";
            }

            const [alkPaiva, alkKuukausi, alkVuosi] = vastausJSON.alkamispvm.split("-");
            const [lopPaiva, lopKuukausi, lopVuosi] = vastausJSON.loppumispvm.split("-");
            const muokattuPaivays = `${parseInt(alkPaiva)}.${parseInt(alkKuukausi)}. - ${parseInt(lopPaiva)}.${parseInt(lopKuukausi)}.${lopVuosi}`;

            vastaus += "<br>" + muokattuPaivays + "</br>" +
                "<br>" + vastausJSON.kesto + " viikkoa</br><p><img src=\"" + vastausJSON.kuva + "\"></p>";
            document.getElementById("vastaus").innerHTML = vastaus;
        }
    </script>
</body>

</html>